/*
 * Jimmy Blaszkiewicz
 * Metro Kreme
 * A Clicking Game unlike Cookie Clicker in every way... 
 * I mean it has Corn...
 */

package cornclicker;


import javax.swing.Timer;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.Random;
import java.util.logging.Level;
import java.util.logging.Logger;
import java.awt.FlowLayout; 
import java.awt.GridLayout;
import java.util.Scanner;
import javax.swing.JFrame; 
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;

public class CornClicker extends JFrame {
    private final JRButton1 grow;
    private final JRButton1 eat;
    private final JRButton1 sell;
    private final JRButton1 upgrades;
    private final JRButton1 store;
    private final JRButton1 cheats;
    
    private static JRButton1 poppingCorn;
    
    private final JPanel buttonPanel;
    private final JPanel labelPanel;
    
    private final JLabel cornLabel;
    private final JLabel moneyLabel;
    private final JLabel sellPerClickLabel;
    private final JLabel growPerClickLabel;
    private final JLabel moneyPerCornLabel;
    private final JLabel sellPerSecondLabel;
    private final JLabel growPerSecondLabel;
    private final JLabel outputLabel;
    
    private final int w = 300;
    private final int h = 35;
    
    private int poppedValue = 50;
    private int poppedChange = 5;
    
    public CornClicker()
    {
        super( "CornClicker" );
        setLayout(new GridLayout(2,1));
        
        buttonPanel = new JPanel();
        buttonPanel.setLayout(new GridLayout(3,2));
        
        grow = new JRButton1("Grow Corn",w,h);
        buttonPanel.add (grow);
        
        eat = new JRButton1 ("Eat the corn",w,h);
        buttonPanel.add (eat);
        
        sell = new JRButton1 ("Sell your product",w,h);
        buttonPanel.add (sell);
        
        upgrades = new JRButton1 ("Upgrades",w,h);
        buttonPanel.add (upgrades);
        
        store = new JRButton1 ("Store",w,h);
        buttonPanel.add (store);
        
        cheats = new JRButton1 ("Enter a Cheat Code.",w,h);
        buttonPanel.add (cheats);
        
        
        labelPanel = new JPanel();
        labelPanel.setLayout(new GridLayout(4,2));
        
        cornLabel = new JLabel("Corn: " + corn);
        labelPanel.add(cornLabel);
        
        moneyLabel = new JLabel("Money: $" + money);
        labelPanel.add(moneyLabel);
        
        sellPerClickLabel = new JLabel("Sell Per Click: " + sellAmount);
        labelPanel.add(sellPerClickLabel);
        
        growPerClickLabel = new JLabel("Grow Per Click: " + growAmount);
        labelPanel.add(growPerClickLabel);
        
        moneyPerCornLabel = new JLabel("Sell Price: $" + sellPrice);
        labelPanel.add(moneyPerCornLabel);
        
        sellPerSecondLabel = new JLabel("Sell Per Second: " + sps);
        labelPanel.add(sellPerSecondLabel);
        
        growPerSecondLabel = new JLabel("Grow Per Second: " + cps);
        labelPanel.add(growPerSecondLabel);
        
        outputLabel = new JLabel("Welcome to CornClicker!");
        labelPanel.add(outputLabel);
        
        add(buttonPanel);
        add(labelPanel);
        
        CornHandler handler1 = new CornHandler();
        grow.addActionListener(handler1);
        
        EatHandler handler2 = new EatHandler();
        eat.addActionListener(handler2);
        
        SellHandler handler3 = new SellHandler();
        sell.addActionListener(handler3);

        UpgradeHandler handler4 = new UpgradeHandler();
        upgrades.addActionListener(handler4);
        
        StoreHandler handler5 = new StoreHandler();
        store.addActionListener(handler5);
        
        CheatHandler handler6 = new CheatHandler();
        cheats.addActionListener(handler6);
        
        new Timer1();
        
    }//end of cornClicker constructor
    int corn = 0;
    int money = 0;
    int sellPrice = 1;
    int sellAmount = 1;
    int growAmount = 1;
    int cps = 0;
    int cornQuality = 0;
    int sps = 0;
    //Timer to control SellPerSecond and CornPerSecond
    public class Timer1 extends JFrame{
        private final Timer timer;
        //private final Timer timerTwo;
        public Timer1(){
            timer = new Timer(1, new TimerListener());
            timer.start();
            //timerTwo = new Timer(1000, new TimerTwoListener());
            //timerTwo.start();
        }
        
        private class TimerListener implements ActionListener
        {   
           int counter = 0;
           public void actionPerformed(ActionEvent event)
            {
                
                if(counter == 1000)
                {
                    corn = corn + cps;
                    if(corn - sps >= 0)
                    {
                        money = money + (sps * sellPrice);
                        corn = corn - sps;
                    }//end if
                    counter = 0;
                }//end if
                counter++;
                
                cornLabel.setText("Corn: " + corn);
                moneyLabel.setText("Money: $" + money);
                sellPerClickLabel.setText("Sell Per Click: " + sellAmount);
                growPerClickLabel.setText("Grow Per Click: " + growAmount);
                moneyPerCornLabel.setText("Sell Price: $" + sellPrice);
                sellPerSecondLabel.setText("Sell Per Second: " + sps);
                growPerSecondLabel.setText("Grow Per Second: " + cps);
                
            }
        }
    }//end of class Timer

    private class CornHandler implements ActionListener
    {   
        public void actionPerformed(ActionEvent event)
        {
            corn = corn + growAmount;
            
        }//end actionPerfomed method
        
    }//end CornHandler Class
    private class EatHandler implements ActionListener
    {  
        public void actionPerformed(ActionEvent event)
        {
            if (corn > 0){
                corn--;
                Random randomGenerator = new Random();
                int randomInt = randomGenerator.nextInt(100);
                if (randomInt >= 90){
                    outputLabel.setText("You get so full that you lose the rest of your corn.");
                    corn = 0;
                }
                else if (randomInt >= 80){
                    try 
                    {
                        outputLabel.setText("You pass out.");
                        Thread.sleep(3000);
                    } 
                    catch (InterruptedException ex) 
                    {
                        Logger.getLogger(CornClicker.class.getName()).log(Level.SEVERE, null, ex);
                    }
                }
                
            }
            if (corn == 0)
                outputLabel.setText("You are out of corn.");
        }//end actionPerfomed method  
    }//end EatHandler Class
    private class SellHandler implements ActionListener
    {
        public void actionPerformed(ActionEvent event)
        {
            if (corn >0){
                corn --;
                money = money + (sellAmount * sellPrice);
                outputLabel.setText("You sell "+ sellAmount +" corns for $" + sellPrice + " a pop.");
                
            }
            if (corn == 0)
                outputLabel.setText("You are out of corn.");
        }//end actionPerformed method
    }//end SellHandler class
    
    private class CheatHandler implements ActionListener
    {
        private Scanner input = new Scanner(System.in);
        public void actionPerformed(ActionEvent event)
        {
            String cheat =
                    JOptionPane.showInputDialog("Enter a cheat code: ");
            
            if(cheat.equals("GIMMESTUFF"))
            {
                money = money + 25000;
                corn = corn + 25000;
            }
            else
            {
                outputLabel.setText("You are bad at cheating.");
                money = 0;
                corn = 0;
            }
        }
    }
    
    public class UpgradeFrame extends JFrame
    {
        private final JRButton1 marry;
        private final JRButton1 move;
        
        public UpgradeFrame()
        {
            super("Upgrades");
            setLayout(new FlowLayout());
            
            marry = new JRButton1("Marry a corn enthusiast: $250",w,h);
            add (marry);
            
            move = new JRButton1("Move to Nebraska: $250",w,h);
            add (move);
            
            poppingCorn = new JRButton1("Make a new strain of corn: $50",w,h);
            add(poppingCorn);
            
            MarryHandler handler1 = new MarryHandler();
            marry.addActionListener(handler1);
            
            MoveHandler handler2 = new MoveHandler();
            move.addActionListener(handler2);
            
            PoppingHandler handler3 = new PoppingHandler();
            poppingCorn.addActionListener(handler3);
                    
        }//end of method UpgradeFrame
        
    }//end of class UpgradeFrame
    private class MoveHandler implements ActionListener
    {
        private boolean moved = false;
        public void actionPerformed (ActionEvent event)
        {
            if (money >= 250 && !moved){
                growAmount = growAmount + 10;
                outputLabel.setText("You can now grow " + growAmount + " corns at a time.");
                moved = true;
                money = money - 250;
            }
            else if (money < 250){
                outputLabel.setText("You cannot afford that right now.");
            }
            else if (moved)
                outputLabel.setText("You already live in Nebraska.");
        }//end of actionPerformed method
    }//end of MoveHandler class
    private class MarryHandler implements ActionListener
    {
        private boolean married = false;
        public void actionPerformed(ActionEvent event)
        {
            if (money >=  250 && !married)
            {
                sellAmount = sellAmount + 10;
                married = true;
                money = money - 250;
            }
                    else if (money < 250){
                outputLabel.setText("Unable to pay off family.");
                money = 0;
                corn = 0;
                
            }
                    else  if (married){
                outputLabel.setText("Cheating is bad");
                money = 0;
                married = false;
                sellAmount = sellAmount - 10;
            }
        }
    }
    
    private class PoppingHandler implements ActionListener
    {
        public void actionPerformed(ActionEvent event)
        {
            if(money>=poppedValue)
            {
                sellPrice = sellPrice + poppedChange;
                money = money - poppedValue;
                outputLabel.setText("You have created a new strain of corn");
                
                poppedValue *= 2;
                poppedChange *= 1.5;
                poppingCorn.setText("Make a new strain of corn: $" + poppedValue);
            }
            else if(money<poppedValue)
            {
                outputLabel.setText("You cannot afford that right now.");
            }
        }
    }
    private class UpgradeHandler implements ActionListener
    {
        public void actionPerformed(ActionEvent event)
        {
            UpgradeFrame upgradeFrame = new UpgradeFrame();
            upgradeFrame.setSize(440,150);
            upgradeFrame.setVisible(true);
            upgradeFrame.setResizable(false);
        }
    }
    public class StoreFrame extends JFrame
    {
        private final JRButton1 cornDealer;
        private final JRButton1 cornFarmer;
        public StoreFrame()
        {
            super("Store");
            setLayout(new FlowLayout());
            
            cornDealer = new JRButton1("Hire a Corn Salesman: $25",w,h);
            add (cornDealer);
            
            cornFarmer = new JRButton1("Hire a Corn Farmer: $25",w,h);
            add(cornFarmer);
            
            DealerHandler handler1 = new DealerHandler();
            cornDealer.addActionListener(handler1);
            
            FarmerHandler handler2 = new FarmerHandler();
            cornFarmer.addActionListener(handler2);
            
        }
    }
    private class DealerHandler implements ActionListener
    {
        
        public void actionPerformed(ActionEvent event)
        {
            
            if(money >= 25)
            {
                sps = sps + 1;
                outputLabel.setText("You have purchased a Salesman");
                money = money - 25;
                MetroSound sound = new MetroSound("ClickSound");
            }
            else
                outputLabel.setText("You cannot afford this right now.");
        }
    }
    private class FarmerHandler implements ActionListener
    {
        public void actionPerformed(ActionEvent event)
        {
            if(money >= 25)
            {
                cps = cps + 1;
                outputLabel.setText("You have purchased a Farmer");
                money = money - 25;
            }
            else{
                outputLabel.setText("You cannot afford that right now.");
            }
        }
    }
    private class StoreHandler implements ActionListener
    {
        public void actionPerformed(ActionEvent event)
        {
            StoreFrame storeFrame = new StoreFrame();
            storeFrame.setSize(440,150);
            storeFrame.setResizable(false);
            storeFrame.setVisible(true);
        }
    }
}//end CornClicker
